<html><head><script>class Warp10GtsPlottingTools extends Object{constructor(){super(),this.id=[],this.data=[],this.names=[],this.color=[],this.params=[],this.currentColorIndex=-1,this.palette=['#001f3f','#0074D9','#7FDBFF','#39CCCC','#3D9970','#2ECC40','#01FF70','#FFDC00','#FF851B','#FF4136','#85144b','#F012BE','#B10DC9','#111111','#AAAAAA','#DDDDDD'],this.maxColors=16,this.MIN_TS=0,this.MAX_TS=9007199254740991}isArray(a){return a&&'object'===typeof a&&a instanceof Array&&'number'===typeof a.length&&'function'===typeof a.splice&&!a.propertyIsEnumerable('length')}isGts(a){return null!==a.c&&null!==a.l&&null!==a.values&&this.isArray(a.values)}isGtsToPlot(a){return!!this.isGts(a)&&'number'===typeof a.values[0].y}equalMetadata(c,a){if(void 0===c.c||void 0===a.c||void 0===c.l||void 0===a.l||!(c.l instanceof Object)||!(a.l instanceof Object))return console.error('[warp10-gts-plotting-tools] equalMetadata','Error in GTS, metadata is not well formed'),!1;if(c.c!==a.c)return!1;for(let b in c.l){if(!a.l.hasOwnProperty(b))return!1;if(c.l[b]!==a.l[b])return!1}for(let b in a.l)if(!c.l.hasOwnProperty(b))return!1;return!0}getColor(a){return this.palette[a%this.maxColors]}currentColor(){return this.getColor(this.currentColorIndex)}nextColor(){return this.currentColorIndex+=1,this.currentColor()}removeColorIfLast(a){if(a===this.currentColor())return this.currentColorIndex-=1}isPlotted(a){return a&&a.id&&0<=this.id.indexOf(a.id)}gtsColor(a){if(!this.isPlotted(a))return'';let b=this.id.indexOf(a.id);return'background-color:'+this.params[b].color+';'}add(a){this.isPlotted(a)||(this.debug&&console.log('[warp10-gts-plotting-tools] add',a),this.data.push(a),this.names.push({c:a.c,l:a.l,id:a.id}),this.params.push({color:this.nextColor()}),this.id.push(a.id))}remove(a){let b;this.isPlotted(a)&&(b=this.id.indexOf(a.id),-1<b&&(this.id.splice(b,1),this.data.splice(b,1),this.names.splice(b,1),this.removeColorIfLast(this.params[b].color),this.params.splice(b,1)))}refresh(a){this.debug&&console.debug('[warp10-gts-plotting-tools] refresh',a);let b=[];this.id.forEach(()=>{b.push(!1)}),this.debug&&console.debug('[warp10-gts-plotting-tools] refresh',b),a.forEach((a)=>{if(this.isPlotted(a)){let c=this.id.indexOf(a.id);this.equalMetadata(this.names[c],a)&&(this.data[c]=a,b[c]=!0)}});for(let c=b.length-1;0<=c;c--)b[c]||(this.id.splice(c,1),this.data.splice(c,1),this.names.splice(c,1),this.removeColorIfLast(this.params[c].color),this.params.splice(c,1))}gtsToNvd3(a){console.warning('[warp10-gts-plotting-tools] Deprecated function gtsToNvd3()','Please don\'t use it ');let b={key:'',values:[],c:'',l:'',id:''};if(b.c=a.c,b.l=a.l,b.id=a.id,b.key=' '+a.id+' - '+a.c,null!==a.l&&(b.key+=' - '+JSON.stringify(a.l)),void 0!==a.v){let c=a.v.sort(function(c,a){return c.ts-a.ts});c.forEach((a)=>{b.values.push({x:Math.round(a.ts/1e3),y:a.value})})}return b}toNvd3Graph(){let a={},b=[];this.debug&&console.log('[warp10-gts-plotting-tools] toNvd3Graph',this.data),this.data.forEach((a,c)=>{if(this.isGtsToPlot(a)){let a=this.data[c];a.color=this.params[c].color,a.key=this.data[c].key,a.area=!1,a.interpolate='step-before',b.push(a)}});return a.sparklines=b,a.tickFormat=function(a){let c=b[0].values[a]&&b[0].values[a].x||0;return c?d3.time.format('%x')(new Date(c)):''},a}getTimeBounds(a){let b={};if(!this.isArray(a))return b;b.min=this.MAX_TS,b.max=this.MIN_TS;for(let c,d=0;d<a.length;d++)c=a[d],b.min>c.values[0].x&&(b.min=c.values[0].x),b.max<c.values[c.values.length-1].x&&(b.max=c.values[c.values.length-1].x);return b}}</script></head><body></body></html>