<html><head><script src="../ace-builds/src-noconflict/ace.js"></script><script src="../ace-builds/src-noconflict/ext-language_tools.js"></script><script src="../ace-builds/src-noconflict/snippets/snippets.js"></script><link rel="import" href="../polymer/polymer.html"><link rel="import" href="./ace-widget-shadow-dom.html"></head><body><dom-module id="ace-widget"><template><style>:host{display:block;width:100%;}#editor{border:1px solid #e3e3e3;border-radius:4px;@apply --ace-widget-editor;}</style><div id="editor"></div></template><script>Polymer({is:'ace-widget',properties:{theme:{type:String,value:'ace/theme/eclipse',observer:'themeChanged'},mode:{type:String,notify:!0,observer:'modeChanged'},value:{type:String,notify:!0,observer:'valueChanged'},readonly:{type:Boolean,value:!1,observer:'readonlyChanged'},softtabs:{type:Boolean,value:!0,observer:'softtabsChanged'},wrap:{type:Boolean,value:!1,observer:'wrapChanged'},fontSize:{type:String,value:'14px',observer:'fontSizeChanged'},tabSize:{type:Number,value:4,observer:'tabSizeChanged'},snippets:{type:String,notify:!0},autoComplete:{type:Object,notify:!0},minlines:{type:Number,value:15},maxlines:{type:Number,value:30},enableLiveAutocompletion:{type:Boolean,value:!1},enableSnippets:{type:Boolean,value:!1},initialFocus:{type:Boolean,value:!1},placeholder:{type:String,value:''},verbose:{type:Boolean,value:!1}},behaviors:[AceWidgetShadowDom],ready:function(){},attached:function(){var a=this.$.editor;a.style.width='100%',a.style.height='100%',this.editor=ace.edit(a),this.init(),this.fire('editor-ready',{value:this.editor,oldValue:null}),this.initializeEditor()},initializeEditor:function(){var a=this,b=this.editor;this.head=document.head,ace.config.set('basePath',this.resolveUrl('../ace-builds/src-min-noconflict/')),this.themeChanged(),this.editorValue='',b.setOption('enableSnippets',this.enableSnippets),b.setOption('enableBasicAutocompletion',!0),b.setOption('enableLiveAutocompletion',this.enableLiveAutocompletion),b.on('change',this.editorChangeAction.bind(this)),b.on('input',this._updatePlaceholder.bind(this)),setTimeout(this._updatePlaceholder.bind(this),100),this.session=b.getSession(),this.initialFocus&&b.focus(),b.$blockScrolling=Infinity,b.setTheme(this.theme),this.readonlyChanged(),this.wrapChanged(),this.tabSizeChanged(),this.modeChanged(),this.softtabsChanged(),this.fontSizeChanged();var c=Polymer.dom(this).innerHTML.trim();if(void 0===this.value?this.value=c:this.valueChanged(),b.setOptions({minLines:this.minlines,maxLines:this.maxlines}),this.enableSnippets){var d=ace.require('ace/snippets').snippetManager;d.register(this.snippets,'javascript')}var e=ace.require('ace/ext/language_tools');e.addCompleter({getCompletions:function(b,c,d,e,f){return 0===e.length?void f(null,[]):void f(null,a.autoComplete||[])}}),this.verbose&&console.debug('[ace-widget] After initializing: editor.getSession().getValue()',b.getSession().getValue())},fontSizeChanged:function(){void 0==this.editor||(this.$.editor.style.fontSize=this.fontSize)},modeChanged:function(){this.editor&&this.editor.getSession().setMode(this.mode)},softtabsChanged:function(){void 0==this.editor||this.editor.getSession().setUseSoftTabs(this.softtabs)},themeChanged:function(){void 0!=this.editor&&this.editor.setTheme(this.theme)},valueChanged:function(){void 0==this.editor||this.editorValue!=this.value&&(this.editorValue=this.value,this.editor.clearSelection(),this.editor.resize())},readonlyChanged:function(){void 0==this.editor||(this.editor.setReadOnly(this.readonly),this.editor.setHighlightActiveLine(!this.readonly),this.editor.setHighlightGutterLine(!this.readonly),this.editor.renderer.$cursorLayer.element.style.opacity=this.readonly?0:1)},wrapChanged:function(){void 0==this.editor||this.editor.getSession().setUseWrapMode(this.wrap)},tabSizeChanged:function(){void 0==this.editor||this.tabSize&&this.editor.getSession().setTabSize(this.tabSize)},editorChangeAction:function(){this.fire('editor-content',{value:this.editorValue,oldValue:this._value})},get editorValue(){return this.editor.getValue()},set editorValue(a){void 0===a||(this._value=a,this.editor.setValue(a))},focus:function(){this.editor.focus()},_updatePlaceholder:function(){var a=!this.editor.session.getValue().length,b=this.editor.renderer.emptyMessageNode;this.verbose&&console.debug('[ace-widget] _updatePlaceholder',{shouldShow:a,node:b}),!a&&b?(this.editor.renderer.scroller.removeChild(this.editor.renderer.emptyMessageNode),this.editor.renderer.emptyMessageNode=null):a&&!b&&(this.verbose&&console.debug('[ace-widget] _updatePlaceholder - shouldShow && !node'),b=this.editor.renderer.emptyMessageNode=document.createElement('div'),b.textContent=this.placeholder,b.className='ace_comment',b.style.padding='0 9px',b.style.zIndex='1',b.style.position='absolute',b.style.color='#aaa',this.verbose&&console.debug('[ace-widget] _updatePlaceholder - node',b),this.editor.renderer.scroller.appendChild(b))}});</script></dom-module></body></html>