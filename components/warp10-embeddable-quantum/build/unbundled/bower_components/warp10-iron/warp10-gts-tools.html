<html><head><link rel="import" href="./warp10-looseJSON.html"><script>(function(){let a={};a.isArray=function(a){return a&&'object'===typeof a&&a instanceof Array&&'number'===typeof a.length&&'function'===typeof a.splice&&!a.propertyIsEnumerable('length')},a.isValidResponse=function(b){let c;try{c=looseJSON.parse(b)}catch(a){return console.error('Response non JSON compliant',b),!1}return!!a.isArray(c)||(console.error('Response isn\'t an Array',c),!1)},a.isEmbeddedImage=function(a){return!1!==typeof a&&/^data:image/.test(a)},a.isEmbeddedImageObject=function(b){return null!==b&&null!==b.image&&null!==b.caption&&a.isEmbeddedImage(b.image)},a.isPositionArray=function(b){if(!b||!b.positions)return!1;if(a.isPositionsArrayWithValues(b)||a.isPositionsArrayWithTwoValues(b))return!0;for(let a in b.positions){if(2>b.positions[a].length||3<b.positions[a].length)return!1;for(let c in b.positions[a])if('number'!==typeof b.positions[a][c])return!1}return!0},a.isPositionsArrayWithValues=function(a){if(null===a||null===a.positions)return!1;for(let b in a.positions){if(3!==a.positions[b].length)return!1;for(let c in a.positions[b])if('number'!==typeof a.positions[b][c])return!1}return!0},a.isPositionsArrayWithTwoValues=function(a){if(null===a||null===a.positions)return!1;for(let b in a.positions){if(4!==a.positions[b].length)return!1;for(let c in a.positions[b])if('number'!==typeof a.positions[b][c])return!1}return!0},a.metricFromJSON=function(a){let b={ts:a[0]};switch(a.length){case 2:b.value=a[1];break;case 3:b.alt=a[1],b.value=a[2];break;case 4:b.lat=a[1],b.lon=a[2],b.value=a[3];break;case 5:b.lat=a[1],b.lon=a[2],b.alt=a[3],b.value=a[4];}return b},a.gtsFromJSON=function(a,b){return{gts:{c:a.c,l:a.l,a:a.a,v:a.v,id:b}}},a.gtsFromJSONList=function(b,c){let d,e,f,g=[];for(e=0;e<b.length;e++)d=b[e],f=void 0!==c&&''!==c?c+'-'+e:''+e,a.isArray(d)&&g.push(a.gtsFromJSONList(d,f)),a.isGts(d)&&g.push(a.gtsFromJSON(d,f)),a.isEmbeddedImage(d)&&g.push({image:d,caption:'Image',id:f}),a.isEmbeddedImageObject(d)&&g.push({image:d.image,caption:d.caption,id:f});return{content:g}},a.flattenGtsIdArray=function(b,a){let c,d;for(a||(a=[]),d=0;d<b.content.length;d++)c=b.content[d],c.content?this.flattenGtsIdArray(c,a):c.gts&&a.push(c.gts);return a},a.serializeGtsMetadata=function(a){let b=[];return Object.keys(a.l).forEach((c)=>{b.push(c+'='+a.l[c])}),(a.id?a.id+' ':'')+a.c+'{'+b.join(',')+'}'},a.gtsToPath=function(a){var b=Math.floor;let c=[];a.v=a.v.sort(function(c,a){return c[0]-a[0]});for(let d,e=0;e<a.v.length;e++)d=a.v[e],2===d.length,3===d.length,4===d.length&&c.push({ts:b(d[0]/1e3),lat:d[1],lon:d[2],val:d[3]}),5===d.length&&c.push({ts:b(d[0]/1e3),lat:d[1],lon:d[2],elev:d[3],val:d[4]});return c},a.equalMetadata=function(c,a){if(void 0===c.c||void 0===a.c||void 0===c.l||void 0===a.l||!(c.l instanceof Object)||!(a.l instanceof Object))return console.error('[warp10-gts-tools] equalMetadata - Error in GTS, metadata is not well formed'),!1;if(c.c!==a.c)return!1;for(let b in c.l){if(!a.l.hasOwnProperty(b))return!1;if(c.l[b]!==a.l[b])return!1}for(let b in a.l)if(!c.l.hasOwnProperty(b))return!1;return!0},a.isGts=function(b){return b&&null!==b&&null!==b.c&&null!==b.l&&null!==b.a&&null!==b.v&&a.isArray(b.v)},a.isGtsToPlot=function(b){if(!a.isGts(b)||0===b.v.length)return!1;for(let a=0;a<b.v.length;a++)if(null!==b.v[a][b.v[a].length-1]){if('number'===typeof b.v[a][b.v[a].length-1]||b.v[a][b.v[a].length-1].constructor.prototype.toFixed!==void 0)return!0;break}return!1},a.isGtsToAnnotate=function(b){if(!a.isGts(b)||0===b.v.length)return!1;for(let a=0;a<b.v.length;a++)if(null!==b.v[a][b.v[a].length-1]){if('number'!==typeof b.v[a][b.v[a].length-1]&&!!b.v[a][b.v[a].length-1].constructor&&'Big'!==b.v[a][b.v[a].length-1].constructor.name&&b.v[a][b.v[a].length-1].constructor.prototype.toFixed===void 0)return!0;break}return!1},a.gtsSort=function(a){a.isSorted||(a.v=a.v.sort(function(c,a){return c[0]-a[0]}),a.isSorted=!0)},a.gtsTimeRange=function(b){return a.gtsSort(b),0===b.v.length?null:[b.v[0][0],b.v[b.v.length-1][0]]},window.gtsTools=a}).call(this);</script></head><body></body></html>